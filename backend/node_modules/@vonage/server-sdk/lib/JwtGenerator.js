"use strict";

var _uuid = require("uuid");

var _jsonwebtoken = _interopRequireDefault(require("jsonwebtoken"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class JwtGenerator {
  /**
   * Generate a JSON Web Token (JWT).
   *
   * @param {Buffer} cert - the private key certificate to be used when signing
   * the claims.
   * @param {Object} claims - additional claims to include within the generated
   * JWT.
   *
   * @returns {String} the generated token
   */
  generate(cert) {
    var claims = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

    if (!(cert instanceof Buffer)) {
      throw new Error("cert must be of type Buffer");
    }

    if (typeof claims !== "object") {
      throw new Error("claims must be of type object");
    }

    var toSign = {
      iat: claims.issuedAt || parseInt(Date.now() / 1000, 10),
      jti: claims.jti || (0, _uuid.v1)()
    };
    Object.keys(claims).forEach(key => {
      toSign[key] = claims[key];
    });

    var token = _jsonwebtoken.default.sign(toSign, cert, {
      algorithm: "RS256"
    });

    return token;
  }

}

module.exports = JwtGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9Kd3RHZW5lcmF0b3IuanMiXSwibmFtZXMiOlsiSnd0R2VuZXJhdG9yIiwiZ2VuZXJhdGUiLCJjZXJ0IiwiY2xhaW1zIiwiQnVmZmVyIiwiRXJyb3IiLCJ0b1NpZ24iLCJpYXQiLCJpc3N1ZWRBdCIsInBhcnNlSW50IiwiRGF0ZSIsIm5vdyIsImp0aSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwidG9rZW4iLCJqd3QiLCJzaWduIiwiYWxnb3JpdGhtIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7OztBQUVBLE1BQU1BLFlBQU4sQ0FBbUI7QUFDakI7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDRUMsRUFBQUEsUUFBUSxDQUFDQyxJQUFELEVBQW9CO0FBQUEsUUFBYkMsTUFBYSx1RUFBSixFQUFJOztBQUMxQixRQUFJLEVBQUVELElBQUksWUFBWUUsTUFBbEIsQ0FBSixFQUErQjtBQUM3QixZQUFNLElBQUlDLEtBQUosQ0FBVSw2QkFBVixDQUFOO0FBQ0Q7O0FBQ0QsUUFBSSxPQUFPRixNQUFQLEtBQWtCLFFBQXRCLEVBQWdDO0FBQzlCLFlBQU0sSUFBSUUsS0FBSixDQUFVLCtCQUFWLENBQU47QUFDRDs7QUFFRCxRQUFJQyxNQUFNLEdBQUc7QUFDWEMsTUFBQUEsR0FBRyxFQUFFSixNQUFNLENBQUNLLFFBQVAsSUFBbUJDLFFBQVEsQ0FBQ0MsSUFBSSxDQUFDQyxHQUFMLEtBQWEsSUFBZCxFQUFvQixFQUFwQixDQURyQjtBQUVYQyxNQUFBQSxHQUFHLEVBQUVULE1BQU0sQ0FBQ1MsR0FBUCxJQUFjO0FBRlIsS0FBYjtBQUlBQyxJQUFBQSxNQUFNLENBQUNDLElBQVAsQ0FBWVgsTUFBWixFQUFvQlksT0FBcEIsQ0FBNkJDLEdBQUQsSUFBUztBQUNuQ1YsTUFBQUEsTUFBTSxDQUFDVSxHQUFELENBQU4sR0FBY2IsTUFBTSxDQUFDYSxHQUFELENBQXBCO0FBQ0QsS0FGRDs7QUFJQSxRQUFJQyxLQUFLLEdBQUdDLHNCQUFJQyxJQUFKLENBQVNiLE1BQVQsRUFBaUJKLElBQWpCLEVBQXVCO0FBQUVrQixNQUFBQSxTQUFTLEVBQUU7QUFBYixLQUF2QixDQUFaOztBQUNBLFdBQU9ILEtBQVA7QUFDRDs7QUE3QmdCOztBQWdDbkJJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQnRCLFlBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjEgYXMgdXVpZHYxIH0gZnJvbSBcInV1aWRcIjtcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuXG5jbGFzcyBKd3RHZW5lcmF0b3Ige1xuICAvKipcbiAgICogR2VuZXJhdGUgYSBKU09OIFdlYiBUb2tlbiAoSldUKS5cbiAgICpcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGNlcnQgLSB0aGUgcHJpdmF0ZSBrZXkgY2VydGlmaWNhdGUgdG8gYmUgdXNlZCB3aGVuIHNpZ25pbmdcbiAgICogdGhlIGNsYWltcy5cbiAgICogQHBhcmFtIHtPYmplY3R9IGNsYWltcyAtIGFkZGl0aW9uYWwgY2xhaW1zIHRvIGluY2x1ZGUgd2l0aGluIHRoZSBnZW5lcmF0ZWRcbiAgICogSldULlxuICAgKlxuICAgKiBAcmV0dXJucyB7U3RyaW5nfSB0aGUgZ2VuZXJhdGVkIHRva2VuXG4gICAqL1xuICBnZW5lcmF0ZShjZXJ0LCBjbGFpbXMgPSB7fSkge1xuICAgIGlmICghKGNlcnQgaW5zdGFuY2VvZiBCdWZmZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjZXJ0IG11c3QgYmUgb2YgdHlwZSBCdWZmZXJcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgY2xhaW1zICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjbGFpbXMgbXVzdCBiZSBvZiB0eXBlIG9iamVjdFwiKTtcbiAgICB9XG5cbiAgICB2YXIgdG9TaWduID0ge1xuICAgICAgaWF0OiBjbGFpbXMuaXNzdWVkQXQgfHwgcGFyc2VJbnQoRGF0ZS5ub3coKSAvIDEwMDAsIDEwKSxcbiAgICAgIGp0aTogY2xhaW1zLmp0aSB8fCB1dWlkdjEoKSxcbiAgICB9O1xuICAgIE9iamVjdC5rZXlzKGNsYWltcykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICB0b1NpZ25ba2V5XSA9IGNsYWltc1trZXldO1xuICAgIH0pO1xuXG4gICAgdmFyIHRva2VuID0gand0LnNpZ24odG9TaWduLCBjZXJ0LCB7IGFsZ29yaXRobTogXCJSUzI1NlwiIH0pO1xuICAgIHJldHVybiB0b2tlbjtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEp3dEdlbmVyYXRvcjtcbiJdfQ==